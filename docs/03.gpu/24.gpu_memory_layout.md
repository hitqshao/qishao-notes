---
title: GPU Memory Layout Papers
date: 2024-09-06
permalink: /pages/45881/
---

1. [3] Static Cost Estimation for Data Layout Selection on GPUs


---
# 1. Static Cost Estimation for Data Layout Selection on GPUs

on the CPU, using Array-of-Struct (AoS) would be more efficient in general, because using AoS would encourage spatial locality. \
in old GPU models before the L1 and L2 cache were introduced, Struct-of-Array (SoA) would usually be preferred since it would achieve better coalescing of memory access.\
The GPU L1 and L2 cache brought back the opportunity of cache reuse, which means merging fields stored in discrete arrays in SoA into a single AoS might lead to better performance.

![image](https://github.com/user-attachments/assets/e66b1b8b-4b92-4825-8de2-0f1b2d693a73)


## Background
Accessing one field will also bring the adjacent fields into the cache.\
On the other hand, SoA may not utilize the cache well, as accessing x[i] will not result in loading y[i] into the cache since x[i] and y[i] are unlikely to be in the same cache line.

on the GPU, using SoA will be more likely to result in more coalesced memory accesses, all threads in the same warp are accessing the same field.\
for different logical data points simultaneously, **using SoA will lead to fewer memory transactions as the same fields are declared in adjacent memory locations.**

AoS might lead to worse coalesced accesses, as declaring different fields in the same struct will waste memory bandwidth when accessing only a single field. Thus, SoA was preferred
on the GPU before the GPU cache was introduced.

![image](https://github.com/user-attachments/assets/47be4998-06ec-4edf-81bc-555a4638e264)

![image](https://github.com/user-attachments/assets/2e9f4e11-0ebf-4922-bc78-b27bdce58880)



