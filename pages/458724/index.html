<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Harnessing Integrated CPU-GPU System Memory for HPC a first look into Grace Hopper | Qi Shao</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="stylesheet" href="custom.css">
    <script language="javascript" type="text/javascript" src="/qishao-notes/js/pgmanor-self.js"></script>
    <meta name="description" content="Computer System">
    <meta name="google-site-verification" content="66w5U9NY5gJWu7iBtHKMbhpXkV94jy31L_RHbvrZZzY">
    <meta name="keywords" content="Hitqishao,golang,vue,go-web,go-admin,go-ldap-admin">
    <meta name="theme-color" content="#11a8cd">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <link rel="preload" href="/qishao-notes/assets/css/0.styles.922e50b3.css" as="style"><link rel="preload" href="/qishao-notes/assets/js/app.c69d2065.js" as="script"><link rel="preload" href="/qishao-notes/assets/js/2.75973713.js" as="script"><link rel="preload" href="/qishao-notes/assets/js/39.837c33da.js" as="script"><link rel="prefetch" href="/qishao-notes/assets/js/10.ff60f5f4.js"><link rel="prefetch" href="/qishao-notes/assets/js/11.35356818.js"><link rel="prefetch" href="/qishao-notes/assets/js/12.9dd6ac7e.js"><link rel="prefetch" href="/qishao-notes/assets/js/13.96e9fb44.js"><link rel="prefetch" href="/qishao-notes/assets/js/14.d32097b1.js"><link rel="prefetch" href="/qishao-notes/assets/js/15.74839805.js"><link rel="prefetch" href="/qishao-notes/assets/js/16.273c8e9e.js"><link rel="prefetch" href="/qishao-notes/assets/js/17.be625961.js"><link rel="prefetch" href="/qishao-notes/assets/js/18.c1ff1604.js"><link rel="prefetch" href="/qishao-notes/assets/js/19.aa8ac1ae.js"><link rel="prefetch" href="/qishao-notes/assets/js/20.535c58a2.js"><link rel="prefetch" href="/qishao-notes/assets/js/21.b5ba1720.js"><link rel="prefetch" href="/qishao-notes/assets/js/22.517515c4.js"><link rel="prefetch" href="/qishao-notes/assets/js/23.cb104322.js"><link rel="prefetch" href="/qishao-notes/assets/js/24.eee2e386.js"><link rel="prefetch" href="/qishao-notes/assets/js/25.6892530d.js"><link rel="prefetch" href="/qishao-notes/assets/js/26.9a920fc3.js"><link rel="prefetch" href="/qishao-notes/assets/js/27.e8d36ebd.js"><link rel="prefetch" href="/qishao-notes/assets/js/28.07f576d2.js"><link rel="prefetch" href="/qishao-notes/assets/js/29.2eae07d2.js"><link rel="prefetch" href="/qishao-notes/assets/js/3.6fbb1390.js"><link rel="prefetch" href="/qishao-notes/assets/js/30.7d0df21b.js"><link rel="prefetch" href="/qishao-notes/assets/js/31.0c998a26.js"><link rel="prefetch" href="/qishao-notes/assets/js/32.87750de9.js"><link rel="prefetch" href="/qishao-notes/assets/js/33.19f8db5c.js"><link rel="prefetch" href="/qishao-notes/assets/js/34.e70e87a1.js"><link rel="prefetch" href="/qishao-notes/assets/js/35.0fc62445.js"><link rel="prefetch" href="/qishao-notes/assets/js/36.57b68851.js"><link rel="prefetch" href="/qishao-notes/assets/js/37.bf2e5910.js"><link rel="prefetch" href="/qishao-notes/assets/js/38.2817b3b0.js"><link rel="prefetch" href="/qishao-notes/assets/js/4.424759af.js"><link rel="prefetch" href="/qishao-notes/assets/js/40.805f6847.js"><link rel="prefetch" href="/qishao-notes/assets/js/41.d4b79d83.js"><link rel="prefetch" href="/qishao-notes/assets/js/42.06a2f39c.js"><link rel="prefetch" href="/qishao-notes/assets/js/43.27963649.js"><link rel="prefetch" href="/qishao-notes/assets/js/44.3e9fe0c0.js"><link rel="prefetch" href="/qishao-notes/assets/js/45.e9f1c4b8.js"><link rel="prefetch" href="/qishao-notes/assets/js/46.4e9ea48b.js"><link rel="prefetch" href="/qishao-notes/assets/js/47.432e980a.js"><link rel="prefetch" href="/qishao-notes/assets/js/48.cb6d511c.js"><link rel="prefetch" href="/qishao-notes/assets/js/49.c01cee0a.js"><link rel="prefetch" href="/qishao-notes/assets/js/5.1d4e5a23.js"><link rel="prefetch" href="/qishao-notes/assets/js/50.96f6fa85.js"><link rel="prefetch" href="/qishao-notes/assets/js/51.28ce45a6.js"><link rel="prefetch" href="/qishao-notes/assets/js/52.d7262ee5.js"><link rel="prefetch" href="/qishao-notes/assets/js/53.c5ea62fd.js"><link rel="prefetch" href="/qishao-notes/assets/js/54.a1fe80b5.js"><link rel="prefetch" href="/qishao-notes/assets/js/55.6b64e045.js"><link rel="prefetch" href="/qishao-notes/assets/js/56.83862bdb.js"><link rel="prefetch" href="/qishao-notes/assets/js/57.27ce620d.js"><link rel="prefetch" href="/qishao-notes/assets/js/58.546cf2bd.js"><link rel="prefetch" href="/qishao-notes/assets/js/6.c982ad78.js"><link rel="prefetch" href="/qishao-notes/assets/js/7.ff277606.js"><link rel="prefetch" href="/qishao-notes/assets/js/8.0b8063cd.js"><link rel="prefetch" href="/qishao-notes/assets/js/9.3863430d.js">
    <link rel="stylesheet" href="/qishao-notes/assets/css/0.styles.922e50b3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/qishao-notes/" class="home-link router-link-active"><!----> <span class="site-name">Qi Shao</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/qishao-notes/" class="nav-link">Home</a></div><div class="nav-item"><a href="/qishao-notes/hbm/" class="nav-link">hbm</a></div><div class="nav-item"><a href="/qishao-notes/compiler/" class="nav-link">compiler</a></div><div class="nav-item"><a href="/qishao-notes/gpu/" class="nav-link">gpu</a></div><div class="nav-item"><a href="/qishao-notes/cpu/" class="nav-link">cpu</a></div><div class="nav-item"><a href="/qishao-notes/llm/" class="nav-link">llm</a></div><div class="nav-item"><a href="/qishao-notes/unix/" class="nav-link">unix</a></div><div class="nav-item"><a href="/qishao-notes/message-board/" class="nav-link">BBS</a></div><div class="nav-item"><a href="https://blog.csdn.net/hit_shaoqi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/hitqshao/qishao-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/qishao-notes/" class="nav-link">Home</a></div><div class="nav-item"><a href="/qishao-notes/hbm/" class="nav-link">hbm</a></div><div class="nav-item"><a href="/qishao-notes/compiler/" class="nav-link">compiler</a></div><div class="nav-item"><a href="/qishao-notes/gpu/" class="nav-link">gpu</a></div><div class="nav-item"><a href="/qishao-notes/cpu/" class="nav-link">cpu</a></div><div class="nav-item"><a href="/qishao-notes/llm/" class="nav-link">llm</a></div><div class="nav-item"><a href="/qishao-notes/unix/" class="nav-link">unix</a></div><div class="nav-item"><a href="/qishao-notes/message-board/" class="nav-link">BBS</a></div><div class="nav-item"><a href="https://blog.csdn.net/hit_shaoqi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/hitqshao/qishao-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/qishao-notes/pages/cc7034/" class="sidebar-link">operand-collector</a></li><li><a href="/qishao-notes/pages/2476ae/" class="sidebar-link">GPU WARP Scheduler</a></li><li><a href="/qishao-notes/pages/14769f/" class="sidebar-link">Precision Exception</a></li><li><a href="/qishao-notes/pages/44771e/" class="sidebar-link">Unified Memory Paper List</a></li><li><a href="/qishao-notes/pages/44871e/" class="sidebar-link">TensorCore Paper List</a></li><li><a href="/qishao-notes/pages/45871e/" class="sidebar-link">Memory Behaviour Paper List</a></li><li><a href="/qishao-notes/pages/45871f/" class="sidebar-link">GPU Virtualization Paper List</a></li><li><a href="/qishao-notes/pages/458720/" class="sidebar-link">Large Language Model Paper List</a></li><li><a href="/qishao-notes/pages/458721/" class="sidebar-link">GPU Simulator</a></li><li><a href="/qishao-notes/pages/458722/" class="sidebar-link">Architectural Survey</a></li><li><a href="/qishao-notes/pages/458724/" aria-current="page" class="active sidebar-link">Harnessing Integrated CPU-GPU System Memory for HPC a first look into Grace Hopper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/qishao-notes/pages/458724/#harnessing-integrated-cpu-gpu-system-memory-for-hpc-a-first-look-into-grace-hopper" class="sidebar-link">Harnessing Integrated CPU-GPU System Memory for HPC: a first look into Grace Hopper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/qishao-notes/pages/458724/#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header level3"><a href="/qishao-notes/pages/458724/#grace-hooper-unified-memory-system" class="sidebar-link">Grace Hooper Unified Memory System</a></li></ul></li></ul></li><li><a href="/qishao-notes/pages/47871e/" class="sidebar-link">TO READ</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/qishao-notes/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/qishao-notes/gpu/#gpu" data-v-06225672>gpu</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/hitqshao" target="_blank" title="作者" class="beLink" data-v-06225672>hitqishao</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-08-10</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Harnessing Integrated CPU-GPU System Memory for HPC a first look into Grace Hopper<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="harnessing-integrated-cpu-gpu-system-memory-for-hpc-a-first-look-into-grace-hopper"><a href="#harnessing-integrated-cpu-gpu-system-memory-for-hpc-a-first-look-into-grace-hopper" class="header-anchor">#</a> Harnessing Integrated CPU-GPU System Memory for HPC: a first look into Grace Hopper</h2> <p>👍 👍 👍</p> <h3 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h3> <h4 id="limitation-of-state-of-art"><a href="#limitation-of-state-of-art" class="header-anchor">#</a> limitation of state-of-art</h4> <ol><li>UVM large overheads in handling page faults in GPU and suffers from read/write amplification due to page-level swapping.</li> <li>Data object offloading requires offline profiling and application refactoring, limiting solution generality.</li> <li>The performance of both solutions is constrained by data transfer bottlenecks between the CPU and GPU.</li></ol> <h4 id="grace-hopper-superchip"><a href="#grace-hopper-superchip" class="header-anchor">#</a> Grace Hopper Superchip</h4> <ul><li>NVLink-C2C (chip-to-chip)  cache-coherent interconnect</li> <li>a single virtual memory space is shared between the CPU and GPU (i.e., system memory)</li> <li>address translation is accelerated by hardware.
<ol><li>direct remote accesses at cacheline granularity</li> <li>heuristic-guided page migrations.</li></ol></li></ul> <p>By leveraging cacheline level access and Address Translation Service (ATS), which enables full access to all CPU and GPU memory allocations, the system memory eliminates the page-fault handling
overhead needed in managed memory in UVM, and minimizes the need for memory migrations.</p> <p>While managed memory splits the virtual memory space into both the system page table and GPU page table, system memory relies on a single system-wide page table, shared between the CPU and the GPU.</p> <h3 id="grace-hooper-unified-memory-system"><a href="#grace-hooper-unified-memory-system" class="header-anchor">#</a> Grace Hooper Unified Memory System</h3> <ul><li>system-allocated memory</li> <li>CUDA managed memory</li></ul> <h4 id="memory-subsystem"><a href="#memory-subsystem" class="header-anchor">#</a> Memory Subsystem</h4> <p>The CPU is connected to 480 GB of LPDDR5X memory, while the GPU is equipped with 96 GB of HBM3 memory.<br>
These two processors, GPU and CPU, are interconnected via the Nvidia NVLink-C2C interconnect.</p> <p>Results show that the GPU’s HBM3 memory achieved a bandwidth of 3.4 TB/s, compared to its theoretical bandwidth of 4 TB/s.<br>
The CPU’s LPDDR5X memory reached a bandwidth of 486 GB/s, close to its theoretical bandwidth of 500 GB/s.</p> <p>We achieved a bandwidth of 375 GB/s for host-to-device (H2D) transfers and 297 GB/s for device-to-host (D2H) transfers, compared to the interconnect’s theoretical bandwidth of 450 GB/s.</p> <h5 id="nvlink-c2c-interconnect"><a href="#nvlink-c2c-interconnect" class="header-anchor">#</a> NVLink-C2C Interconnect</h5> <p>In the Grace Hopper system, a processor (CPU or GPU) can directly access the other processor’s physical memory over the NVLink-C2C interconnect.<br>
Cacheline granularity, with transfer sizes as small as 64 bytes on the CPU side and 128 bytes on the GPU side.</p> <h5 id="system-level-address-translation"><a href="#system-level-address-translation" class="header-anchor">#</a> System-level Address Translation</h5> <p>Grace CPU features a unique hardware unit called the <strong>System Memory Management Unit (SMMU)</strong>.</p> <p>The SMMU is responsible for translating virtual addresses to physical addresses by performing page table walks.<br>
Compared to a traditional MMU, the SMMU provides additional support for virtual-to-physical address translation requests from the GPU.</p> <p><strong>This is the flow that GPU TLB cached mapping and GPU wish to access physical memory stored in CPU memory system.</strong></p> <p><img src="https://github.com/user-attachments/assets/a26fb78a-ada8-4098-8300-e15a44d27418" alt="image"></p> <p>Access Flow:</p> <ul><li>A GPU thread accesses a virtual address.</li> <li>The data is not cached in the GPU cache hierarchy. This generates a cache miss.</li> <li>The virtual address is looked up in the GPU TLBs (Translation Lookaside Buffers) for virtual-to-physical translation.<br>
As the translation is already cached, it is used to perform an access to physical memory.</li> <li>The GMMU initiates a direct memory access (DMA) over the NVLink-C2C interconnect, at the cacheline granularity.</li> <li>The requested access is performed from CPU memory, and send back to the GPU.</li> <li>The access is completed, and memory is cached in the regular GPU cache hierarchy.</li></ul> <p>Compared to pre-Grace Hopper systems, which rely on <strong>GPU page fault handling to access CPU memory</strong>, this new approach has two main implications.</p> <ul><li>First, GPU accesses to CPU-located memory no longer systematically trigger GPU page faults.</li> <li>Second, page faults are now generated by the SMMU and can be directly handled by the operating system’s page fault handling mechanism, simplifying the overall process.</li></ul> <h5 id="memory-management-in-grace-hopper"><a href="#memory-management-in-grace-hopper" class="header-anchor">#</a> Memory Management in Grace Hopper</h5> <p>two distinct page tables</p> <ul><li>system-wide page table</li> <li>GPU-exclusive page table</li></ul> <p>Memory allocation</p> <ul><li>allocations in CPU physical memory only</li> <li>allocations in GPU physical memory only</li> <li>allocations that can reside in either CPU or GPU physical memory</li></ul> <p>a system-wide page table, <strong>located in CPU memory.</strong><br>
The operating system directly accesses this page table, creates and manages page table entries (PTEs). <br>
The SMMU uses this page table to provide virtual-to-physical address translation for both the CPU (when required by user applications) and the GPU (when requested over the NVLink-C2C interconnect). <br>
Memory pages in the system-wide page table can be physically located in either CPU or GPU memory, and they use the system page size, which is defined at the operating system level and constrained by the CPU architecture capabilities.<br>
When using the Grace CPU, the page size is either 4 KB or 64 KB.</p> <p>GPU-exclusive Page Table
The Grace Hopper system retains the local GPU page table from previous generations of Nvidia GPUs.<br>
This page table, located in GPU memory and <strong>only accessible by the GPU</strong>, stores virtual-to-physical translations for cudaMalloc allocations and cudaMallocManaged allocations when the physical location of the managed memory is on the GPU.<br>
The page size used by this page table is 2 MB.</p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/hitqshao/qishao-notes/edit/main/docs/03.gpu/11.IntegratedCPUGPUMemory.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/08/10, 22:05:40</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/qishao-notes/pages/458722/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Architectural Survey</div></a> <a href="/qishao-notes/pages/47871e/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">TO READ</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/qishao-notes/pages/458722/" class="prev">Architectural Survey</a></span> <span class="next"><a href="/qishao-notes/pages/47871e/">TO READ</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="https://github.com/hitqshao" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="mailto:hitqshao@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://gitee.com/hitqshao" title="Gitee" target="_blank" class="iconfont icon-gitee"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2024
    <span>Eryajf | <a href="https://github.com/hitqshao/qishao-notes/blob/main/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/qishao-notes/assets/js/app.c69d2065.js" defer></script><script src="/qishao-notes/assets/js/2.75973713.js" defer></script><script src="/qishao-notes/assets/js/39.837c33da.js" defer></script>
  </body>
</html>
